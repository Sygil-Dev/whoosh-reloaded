<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Whoosh 1.x release notes &mdash; Whoosh-Reloaded 2.7.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Whoosh 0.3 release notes" href="0_3.html" />
    <link rel="prev" title="Whoosh 2.x release notes" href="2_0.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Whoosh-Reloaded
          </a>
              <div class="version">
                2.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Release notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2_0.html">Whoosh 2.x release notes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Whoosh 1.x release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-8-3">Whoosh 1.8.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-8-2">Whoosh 1.8.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-8-1">Whoosh 1.8.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-8">Whoosh 1.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-7-7">Whoosh 1.7.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-7">Whoosh 1.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-6">Whoosh 1.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-5">Whoosh 1.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-3">Whoosh 1.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-2">Whoosh 1.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whoosh-1-0">Whoosh 1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-api-changes">User API changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#misc">Misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0_3.html">Whoosh 0.3 release notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction to Whoosh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schema.html">Designing a schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indexing.html">How to index documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searching.html">How to search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parsing.html">Parsing user queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../querylang.html">The default query language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dates.html">Indexing and parsing dates/times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../query.html">Query objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">About analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stemming.html">Stemming, variations, and accent folding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ngrams.html">Indexing and searching N-grams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../facets.html">Sorting and faceting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../highlight.html">How to create highlighted search result excerpts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../keywords.html">Query expansion and Key word extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spelling.html">“Did you mean… ?” Correcting errors in user queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fieldcaches.html">Field caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch.html">Tips for speeding up batch indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threads.html">Concurrency, locking, and versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nested.html">Indexing and searching document hierarchies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Whoosh recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">Whoosh API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tech/index.html">Technical notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Whoosh-Reloaded</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Release notes</a></li>
      <li class="breadcrumb-item active">Whoosh 1.x release notes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/releases/1_0.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="whoosh-1-x-release-notes">
<h1>Whoosh 1.x release notes<a class="headerlink" href="#whoosh-1-x-release-notes" title="Permalink to this heading">¶</a></h1>
<section id="whoosh-1-8-3">
<h2>Whoosh 1.8.3<a class="headerlink" href="#whoosh-1-8-3" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.8.3 contains important bugfixes and new functionality. Thanks to all
the mailing list and BitBucket users who helped with the fixes!</p>
<p>Fixed a bad <code class="docutils literal notranslate"><span class="pre">Collector</span></code> bug where the docset of a Results object did not match
the actual results.</p>
<p>You can now pass a sequence of objects to a keyword argument in <code class="docutils literal notranslate"><span class="pre">add_document</span></code>
and <code class="docutils literal notranslate"><span class="pre">update_document</span></code> (currently this will not work for unique fields in
<code class="docutils literal notranslate"><span class="pre">update_document</span></code>). This is useful for non-text fields such as <code class="docutils literal notranslate"><span class="pre">DATETIME</span></code>
and <code class="docutils literal notranslate"><span class="pre">NUMERIC</span></code>, allowing you to index multiple dates/numbers for a document:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span><span class="o">.</span><span class="n">add_document</span><span class="p">(</span><span class="n">shoe</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;Saucony Kinvara&quot;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
<p>This version reverts to using the CDB hash function for hash files instead of
Python’s <code class="docutils literal notranslate"><span class="pre">hash()</span></code> because the latter is not meant to be stored externally.
This change maintains backwards compatibility with old files.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Searcher.search</span></code> method now takes a <code class="docutils literal notranslate"><span class="pre">mask</span></code> keyword argument. This is
the opposite of the <code class="docutils literal notranslate"><span class="pre">filter</span></code> argument. Where the <code class="docutils literal notranslate"><span class="pre">filter</span></code> specifies the
set of documents that can appear in the results, the <code class="docutils literal notranslate"><span class="pre">mask</span></code> specifies a
set of documents that must not appear in the results.</p>
<p>Fixed performance problems in <code class="docutils literal notranslate"><span class="pre">Searcher.more_like</span></code>. This method now also
takes a <code class="docutils literal notranslate"><span class="pre">filter</span></code> keyword argument like <code class="docutils literal notranslate"><span class="pre">Searcher.search</span></code>.</p>
<p>Improved documentation.</p>
</section>
<section id="whoosh-1-8-2">
<h2>Whoosh 1.8.2<a class="headerlink" href="#whoosh-1-8-2" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.8.2 fixes some bugs, including a mistyped signature in
Searcher.more_like and a bad bug in Collector that could screw up the
ordering of results given certain parameters.</p>
</section>
<section id="whoosh-1-8-1">
<h2>Whoosh 1.8.1<a class="headerlink" href="#whoosh-1-8-1" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.8.1 includes a few recent bugfixes/improvements:</p>
<ul class="simple">
<li><p>ListMatcher.skip_to_quality() wasn’t returning an integer, resulting
in a “None + int” error.</p></li>
<li><p>Fixed locking and memcache sync bugs in the Google App Engine storage
object.</p></li>
<li><p>MultifieldPlugin wasn’t working correctly with groups.</p>
<ul>
<li><p>The binary matcher trees of Or and And are now generated using a
Huffman-like algorithm instead perfectly balanced. This gives a
noticeable speed improvement because less information has to be passed
up/down the tree.</p></li>
</ul>
</li>
</ul>
</section>
<section id="whoosh-1-8">
<h2>Whoosh 1.8<a class="headerlink" href="#whoosh-1-8" title="Permalink to this heading">¶</a></h2>
<p>This release relicensed the Whoosh source code under the Simplified BSD (A.K.A.
“two-clause” or “FreeBSD”) license. See LICENSE.txt for more information.</p>
</section>
<section id="whoosh-1-7-7">
<h2>Whoosh 1.7.7<a class="headerlink" href="#whoosh-1-7-7" title="Permalink to this heading">¶</a></h2>
<p>Setting a TEXT field to store term vectors is now much easier. Instead of
having to pass an instantiated whoosh.formats.Format object to the vector=
keyword argument, you can pass True to automatically use the same format and
analyzer as the inverted index. Alternatively, you can pass a Format subclass
and Whoosh will instantiate it for you.</p>
<p>For example, to store term vectors using the same settings as the inverted
index (Positions format and StandardAnalyzer):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whoosh.fields</span> <span class="kn">import</span> <span class="n">Schema</span><span class="p">,</span> <span class="n">TEXT</span>

<span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">TEXT</span><span class="p">(</span><span class="n">vector</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>To store term vectors that use the same analyzer as the inverted index
(StandardAnalyzer by default) but only store term frequency:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whoosh.formats</span> <span class="kn">import</span> <span class="n">Frequency</span>

<span class="n">schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">TEXT</span><span class="p">(</span><span class="n">vector</span><span class="o">=</span><span class="n">Frequency</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that currently the only place term vectors are used in Whoosh is keyword
extraction/more like this, but they can be useful for expert users with custom
code.</p>
<p>Added :meth:` whoosh.searching.Searcher.more_like` and
:meth:` whoosh.searching.Hit.more_like_this` methods, as shortcuts for doing
keyword extraction yourself. Return a Results object.</p>
<p>“python setup.py test” works again, as long as you have nose installed.</p>
<p>The :meth:` whoosh.searching.Searcher.sort_query_using` method lets you sort documents matching a given query using an arbitrary function. Note that like “complex” searching with the Sorter object, this can be slow on large multi-segment indexes.</p>
</section>
<section id="whoosh-1-7">
<h2>Whoosh 1.7<a class="headerlink" href="#whoosh-1-7" title="Permalink to this heading">¶</a></h2>
<p>You can once again perform complex sorting of search results (that is, a sort
with some fields ascending and some fields descending).</p>
<p>You can still use the <code class="docutils literal notranslate"><span class="pre">sortedby</span></code> keyword argument to
:meth:` whoosh.searching.Searcher.search` to do a simple sort (where all fields
are sorted in the same direction), or you can use the new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Sorter</span></code> class to do a simple or complex sort:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">searcher</span> <span class="o">=</span> <span class="n">myindex</span><span class="o">.</span><span class="n">searcher</span><span class="p">()</span>
<span class="n">sorter</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">sorter</span><span class="p">()</span>
<span class="c1"># Sort first by the group field, ascending</span>
<span class="n">sorter</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
<span class="c1"># Then by the price field, descending</span>
<span class="n">sorter</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Get the Results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">sorter</span><span class="o">.</span><span class="n">sort_query</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span>
</pre></div>
</div>
<p>See the documentation for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Sorter</span></code> class for more
information. Bear in mind that complex sorts will be much slower on large
indexes because they can’t use the per-segment field caches.</p>
<p>You can now get highlighted snippets for a hit automatically using
:meth:` whoosh.searching.Hit.highlights`:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">myquery</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">hit</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="nb">print</span> <span class="n">hit</span><span class="o">.</span><span class="n">highlights</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>See :meth:` whoosh.searching.Hit.highlights` for more information.</p>
<p>Added the ability to filter search results so that only hits in a Results
set, a set of docnums, or matching a query are returned. The filter is
cached on the searcher.</p>
<blockquote>
<div><p># Search within previous results
newresults = searcher.search(newquery, filter=oldresults)</p>
<p># Search within the “basics” chapter
results = searcher.search(userquery, filter=query.Term(“chapter”, “basics”))</p>
</div></blockquote>
<p>You can now specify a time limit for a search. If the search does not finish
in the given time, a :class:` whoosh.searching.TimeLimit` exception is raised,
but you can still retrieve the partial results from the collector. See the
<code class="docutils literal notranslate"><span class="pre">timelimit</span></code> and <code class="docutils literal notranslate"><span class="pre">greedy</span></code> arguments in the
:class:` whoosh.searching.Collector` documentation.</p>
<p>Added back the ability to set :class:` whoosh.analysis.StemFilter` to use an
unlimited cache. This is useful for one-shot batch indexing (see
<a class="reference internal" href="../batch.html"><span class="doc">Tips for speeding up batch indexing</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">normalize()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">And</span></code> and <code class="docutils literal notranslate"><span class="pre">Or</span></code> queries now merges
overlapping range queries for more efficient queries.</p>
<p>Query objects now have <code class="docutils literal notranslate"><span class="pre">__hash__</span></code> methods allowing them to be used as
dictionary keys.</p>
<p>The API of the highlight module has changed slightly. Most of the functions
in the module have been converted to classes. However, most old code should
still work. The <code class="docutils literal notranslate"><span class="pre">NullFragmeter</span></code> is now called <code class="docutils literal notranslate"><span class="pre">WholeFragmenter</span></code>, but the
old name is still available as an alias.</p>
<p>Fixed MultiPool so it won’t fill up the temp directory with job files.</p>
<p>Fixed a bug where Phrase query objects did not use their boost factor.</p>
<p>Fixed a bug where a fieldname after an open parenthesis wasn’t parsed
correctly. The change alters the semantics of certain parsing “corner cases”
(such as <code class="docutils literal notranslate"><span class="pre">a:b:c:d</span></code>).</p>
</section>
<section id="whoosh-1-6">
<h2>Whoosh 1.6<a class="headerlink" href="#whoosh-1-6" title="Permalink to this heading">¶</a></h2>
<p>The `` whoosh.writing.BatchWriter`` class is now called
:class:` whoosh.writing.BufferedWriter`. It is similar to the old <code class="docutils literal notranslate"><span class="pre">BatchWriter</span></code>
class but allows you to search and update the buffered documents as well as the
documents that have been flushed to disk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">writing</span><span class="o">.</span><span class="n">BufferedWriter</span><span class="p">(</span><span class="n">myindex</span><span class="p">)</span>

<span class="c1"># You can update (replace) documents in RAM without having to commit them</span>
<span class="c1"># to disk</span>
<span class="n">writer</span><span class="o">.</span><span class="n">add_document</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/a&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hi there&quot;</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">update_document</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/a&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello there&quot;</span><span class="p">)</span>

<span class="c1"># Search committed and uncommited documents by getting a searcher from the</span>
<span class="c1"># writer instead of the index</span>
<span class="n">searcher</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">searcher</span><span class="p">()</span>
</pre></div>
</div>
<p>(BatchWriter is still available as an alias for backwards compatibility.)</p>
<p>The :class:` whoosh.qparser.QueryParser` initialization method now requires a
schema as the second argument. Previously the default was to create a
<code class="docutils literal notranslate"><span class="pre">QueryParser</span></code> without a schema, which was confusing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qp</span> <span class="o">=</span> <span class="n">qparser</span><span class="o">.</span><span class="n">QueryParser</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">myindex</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
<p>The :meth:` whoosh.searching.Searcher.search` method now takes a <code class="docutils literal notranslate"><span class="pre">scored</span></code>
keyword. If you search with <code class="docutils literal notranslate"><span class="pre">scored=False</span></code>, the results will be in “natural”
order (the order the documents were added to the index). This is useful when
you don’t need scored results but want the convenience of the Results object.</p>
<p>Added the :class:` whoosh.qparser.GtLtPlugin` parser plugin to allow greater
than/less as an alternative syntax for ranges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">:</span><span class="o">&gt;</span><span class="mi">100</span> <span class="n">tag</span><span class="p">:</span><span class="o">&lt;=</span><span class="n">zebra</span> <span class="n">date</span><span class="p">:</span><span class="o">&gt;=</span><span class="s1">&#39;29 march 2001&#39;</span>
</pre></div>
</div>
<p>Added the ability to define schemas declaratively, similar to Django models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whoosh</span> <span class="kn">import</span> <span class="n">index</span>
<span class="kn">from</span> <span class="nn">whoosh.fields</span> <span class="kn">import</span> <span class="n">SchemaClass</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">KEYWORD</span><span class="p">,</span> <span class="n">STORED</span><span class="p">,</span> <span class="n">TEXT</span>

<span class="k">class</span> <span class="nc">MySchema</span><span class="p">(</span><span class="n">SchemaClass</span><span class="p">):</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">ID</span><span class="p">(</span><span class="n">stored</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">STORED</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">KEYWORD</span><span class="p">(</span><span class="n">stored</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TEXT</span>

<span class="n">index</span><span class="o">.</span><span class="n">create_in</span><span class="p">(</span><span class="s2">&quot;indexdir&quot;</span><span class="p">,</span> <span class="n">MySchema</span><span class="p">)</span>
</pre></div>
</div>
<p>Whoosh 1.6.2: Added :class:` whoosh.searching.TermTrackingCollector` which tracks
which part of the query matched which documents in the final results.</p>
<p>Replaced the unbounded cache in :class:` whoosh.analysis.StemFilter` with a
bounded LRU (least recently used) cache. This will make stemming analysis
slightly slower but prevent it from eating up too much memory over time.</p>
<p>Added a simple :class:` whoosh.analysis.PyStemmerFilter` that works when the
py-stemmer library is installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ana</span> <span class="o">=</span> <span class="n">RegexTokenizer</span><span class="p">()</span> <span class="o">|</span> <span class="n">PyStemmerFilter</span><span class="p">(</span><span class="s2">&quot;spanish&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimation of memory usage for the <code class="docutils literal notranslate"><span class="pre">limitmb</span></code> keyword argument to
<code class="docutils literal notranslate"><span class="pre">FileIndex.writer()</span></code> is more accurate, which should help keep memory usage
memory usage by the sorting pool closer to the limit.</p>
<p>The `` whoosh.ramdb`` package was removed and replaced with a single
`` whoosh.ramindex`` module.</p>
<p>Miscellaneous bug fixes.</p>
</section>
<section id="whoosh-1-5">
<h2>Whoosh 1.5<a class="headerlink" href="#whoosh-1-5" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Whoosh 1.5 is incompatible with previous indexes. You must recreate
existing indexes with Whoosh 1.5.</p>
</div>
<p>Fixed a bug where postings were not portable across different endian platforms.</p>
<p>New generalized field cache system, using per-reader caches, for much faster
sorting and faceting of search results, as well as much faster multi-term (e.g.
prefix and wildcard) and range queries, especially for large indexes and/or
indexes with multiple segments.</p>
<p>Changed the faceting API. See <a class="reference internal" href="../facets.html"><span class="doc">Sorting and faceting</span></a>.</p>
<p>Faster storage and retrieval of posting values.</p>
<p>Added per-field <code class="docutils literal notranslate"><span class="pre">multitoken_query</span></code> attribute to control how the query parser
deals with a “term” that when analyzed generates multiple tokens. The default
value is <cite>“first”</cite> which throws away all but the first token (the previous
behavior). Other possible values are <cite>“and”</cite>, <cite>“or”</cite>, or <cite>“phrase”</cite>.</p>
<p>Added :class:` whoosh.analysis.DoubleMetaphoneFilter`,
:class:` whoosh.analysis.SubstitutionFilter`, and
:class:` whoosh.analysis.ShingleFilter`.</p>
<p>Added :class:` whoosh.qparser.CopyFieldPlugin`.</p>
<p>Added :class:` whoosh.query.Otherwise`.</p>
<p>Generalized parsing of operators (such as OR, AND, NOT, etc.) in the query
parser to make it easier to add new operators. In intend to add a better API
for this in a future release.</p>
<p>Switched NUMERIC and DATETIME fields to use more compact on-disk
representations of numbers.</p>
<p>Fixed a bug in the porter2 stemmer when stemming the string <cite>“y”</cite>.</p>
<p>Added methods to :class:` whoosh.searching.Hit` to make it more like a <cite>dict</cite>.</p>
<p>Short posting lists (by default, single postings) are inline in the term file
instead of written to the posting file for faster retrieval and a small saving
in disk space.</p>
</section>
<section id="whoosh-1-3">
<h2>Whoosh 1.3<a class="headerlink" href="#whoosh-1-3" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.3 adds a more efficient DATETIME field based on the new tiered NUMERIC
field, and the DateParserPlugin. See <a class="reference internal" href="../dates.html"><span class="doc">Indexing and parsing dates/times</span></a>.</p>
</section>
<section id="whoosh-1-2">
<h2>Whoosh 1.2<a class="headerlink" href="#whoosh-1-2" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.2 adds tiered indexing for NUMERIC fields, resulting in much faster
range queries on numeric fields.</p>
</section>
<section id="whoosh-1-0">
<h2>Whoosh 1.0<a class="headerlink" href="#whoosh-1-0" title="Permalink to this heading">¶</a></h2>
<p>Whoosh 1.0 is a major milestone release with vastly improved performance and
several useful new features.</p>
<p><em>The index format of this version is not compatibile with indexes created by
previous versions of Whoosh</em>. You will need to reindex your data to use this
version.</p>
<p>Orders of magnitude faster searches for common terms. Whoosh now uses
optimizations similar to those in Xapian to skip reading low-scoring postings.</p>
<p>Faster indexing and ability to use multiple processors (via <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code>
module) to speed up indexing.</p>
<p>Flexible Schema: you can now add and remove fields in an index with the
:meth:` whoosh.writing.IndexWriter.add_field` and
:meth:` whoosh.writing.IndexWriter.remove_field` methods.</p>
<p>New hand-written query parser based on plug-ins. Less brittle, more robust,
more flexible, and easier to fix/improve than the old pyparsing-based parser.</p>
<p>On-disk formats now use 64-bit disk pointers allowing files larger than 4 GB.</p>
<p>New :class:` whoosh.searching.Facets` class efficiently sorts results into
facets based on any criteria that can be expressed as queries, for example
tags or price ranges.</p>
<p>New :class:` whoosh.writing.BatchWriter` class automatically batches up
individual <code class="docutils literal notranslate"><span class="pre">add_document</span></code> and/or <code class="docutils literal notranslate"><span class="pre">delete_document</span></code> calls until a certain
number of calls or a certain amount of time passes, then commits them all at
once.</p>
<p>New :class:` whoosh.analysis.BiWordFilter` lets you create bi-word indexed
fields a possible alternative to phrase searching.</p>
<p>Fixed bug where files could be deleted before a reader could open them  in
threaded situations.</p>
<p>New :class:` whoosh.analysis.NgramFilter` filter,
:class:` whoosh.analysis.NgramWordAnalyzer` analyzer, and
:class:` whoosh.fields.NGRAMWORDS` field type allow producing n-grams from
tokenized text.</p>
<p>Errors in query parsing now raise a specific `` whoosh.qparse.QueryParserError``
exception instead of a generic exception.</p>
<p>Previously, the query string <code class="docutils literal notranslate"><span class="pre">*</span></code> was optimized to a
:class:` whoosh.query.Every` query which matched every document. Now the
<code class="docutils literal notranslate"><span class="pre">Every</span></code> query only matches documents that actually have an indexed term from
the given field, to better match the intuitive sense of what a query string like
<code class="docutils literal notranslate"><span class="pre">tag:*</span></code> should do.</p>
<p>New :meth:` whoosh.searching.Searcher.key_terms_from_text` method lets you
extract key words from arbitrary text instead of documents in the index.</p>
<p>Previously the :meth:` whoosh.searching.Searcher.key_terms` and
:meth:` whoosh.searching.Results.key_terms` methods required that the given
field store term vectors. They now also work if the given field is stored
instead. They will analyze the stored string into a term vector on-the-fly.
The field must still be indexed.</p>
</section>
<section id="user-api-changes">
<h2>User API changes<a class="headerlink" href="#user-api-changes" title="Permalink to this heading">¶</a></h2>
<p>The default for the <code class="docutils literal notranslate"><span class="pre">limit</span></code> keyword argument to
:meth:` whoosh.searching.Searcher.search` is now <code class="docutils literal notranslate"><span class="pre">10</span></code>. To return all results
in a single <code class="docutils literal notranslate"><span class="pre">Results</span></code> object, use <code class="docutils literal notranslate"><span class="pre">limit=None</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Index</span></code> object no longer represents a snapshot of the index at the time
the object was instantiated. Instead it always represents the index in the
abstract. <code class="docutils literal notranslate"><span class="pre">Searcher</span></code> and <code class="docutils literal notranslate"><span class="pre">IndexReader</span></code> objects obtained from the
<code class="docutils literal notranslate"><span class="pre">Index</span></code> object still represent the index as it was at the time they were
created.</p>
<p>Because the <code class="docutils literal notranslate"><span class="pre">Index</span></code> object no longer represents the index at a specific
version, several methods such as <code class="docutils literal notranslate"><span class="pre">up_to_date</span></code> and <code class="docutils literal notranslate"><span class="pre">refresh</span></code> were removed
from its interface. The Searcher object now has
<code class="xref py py-meth docutils literal notranslate"><span class="pre">last_modified()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">up_to_date()</span></code>, and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">refresh()</span></code> methods similar to those that used to
be on <code class="docutils literal notranslate"><span class="pre">Index</span></code>.</p>
<p>The document deletion and field add/remove methods on the <code class="docutils literal notranslate"><span class="pre">Index</span></code> object now
create a writer behind the scenes to accomplish each call. This means they write
to the index immediately, so you don’t need to call <code class="docutils literal notranslate"><span class="pre">commit</span></code> on the <code class="docutils literal notranslate"><span class="pre">Index</span></code>.
Also, it will be much faster if you need to call them multiple times to create
your own writer instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t do this</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">my_list_of_ids_to_delete</span><span class="p">:</span>
    <span class="n">myindex</span><span class="o">.</span><span class="n">delete_by_term</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
<span class="n">myindex</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Instead do this</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">myindex</span><span class="o">.</span><span class="n">writer</span><span class="p">()</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">my_list_of_ids_to_delete</span><span class="p">:</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">delete_by_term</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">postlimit</span></code> argument to <code class="docutils literal notranslate"><span class="pre">Index.writer()</span></code> has been changed to
<code class="docutils literal notranslate"><span class="pre">postlimitmb</span></code> and is now expressed in megabytes instead of bytes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">myindex</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">postlimitmb</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</pre></div>
</div>
<p>Instead of having to import `` whoosh.filedb.filewriting.NO_MERGE`` or
`` whoosh.filedb.filewriting.OPTIMIZE`` to use as arguments to <code class="docutils literal notranslate"><span class="pre">commit()</span></code>, you
can now simply do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do not merge segments</span>
<span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">merge</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># or</span>

<span class="c1"># Merge all segments</span>
<span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The `` whoosh.postings`` module is gone. The `` whoosh.matching`` module contains
classes for posting list readers.</p>
<p>Whoosh no longer maps field names to numbers for internal use or writing to
disk. Any low-level method that accepted field numbers now accept field names
instead.</p>
<p>Custom Weighting implementations that use the <code class="docutils literal notranslate"><span class="pre">final()</span></code> method must now
set the <code class="docutils literal notranslate"><span class="pre">use_final</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whoosh.scoring</span> <span class="kn">import</span> <span class="n">BM25F</span>

<span class="k">class</span> <span class="nc">MyWeighting</span><span class="p">(</span><span class="n">BM25F</span><span class="p">):</span>
    <span class="n">use_final</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">final</span><span class="p">(</span><span class="n">searcher</span><span class="p">,</span> <span class="n">docnum</span><span class="p">,</span> <span class="n">score</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">score</span> <span class="o">+</span> <span class="n">docnum</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>
</div>
<p>This disables the new optimizations, forcing Whoosh to score every matching
document.</p>
<p>:class:` whoosh.writing.AsyncWriter` now takes an :class:` whoosh.index.Index`
object as its first argument, not a callable. Also, the keyword arguments to
pass to the index’s <code class="docutils literal notranslate"><span class="pre">writer()</span></code> method should now be passed as a dictionary
using the <code class="docutils literal notranslate"><span class="pre">writerargs</span></code> keyword argument.</p>
<p>Whoosh now stores per-document field length using an approximation rather than
exactly. For low numbers the approximation is perfectly accurate, while high
numbers will be approximated less accurately.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">doc_field_length</span></code> method on searchers and readers now takes a second
argument representing the default to return if the given document and field
do not have a length (i.e. the field is not scored or the field was not
provided for the given document).</p>
<p>The :class:` whoosh.analysis.StopFilter` now has a <code class="docutils literal notranslate"><span class="pre">maxsize</span></code> argument as well
as a <code class="docutils literal notranslate"><span class="pre">minsize</span></code> argument to its initializer. Analyzers that use the
<code class="docutils literal notranslate"><span class="pre">StopFilter</span></code> have the <code class="docutils literal notranslate"><span class="pre">maxsize</span></code> argument in their initializers now also.</p>
<p>The interface of :class:` whoosh.writing.AsyncWriter` has changed.</p>
</section>
<section id="misc">
<h2>Misc<a class="headerlink" href="#misc" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Because the file backend now writes 64-bit disk pointers and field names
instead of numbers, the size of an index on disk will grow compared to
previous versions.</p></li>
<li><p>Unit tests should no longer leave directories and files behind.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2_0.html" class="btn btn-neutral float-left" title="Whoosh 2.x release notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="0_3.html" class="btn btn-neutral float-right" title="Whoosh 0.3 release notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2007-2012 Matt Chaput.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>